var glob = require( 'glob'),
	path = require( 'path'),
	_    = require( 'underscore' )

module.exports = function( pattern, config ) {
	var removeRootPathFromFilePath = function( filePath, rootPath ) {
		return filePath.substr( rootPath.length )
	}

	var tmpPattern = pattern,
		result     = []

	if( !!config && !!config.root ) {

		var tmpRoot = path.relative( process.cwd(), config.root)

		tmpPattern = tmpRoot + pattern
		result = glob.sync( tmpPattern.replace( /\\/g, "/" ) )

		result = _.map( result, function( filePath) { return removeRootPathFromFilePath( filePath, tmpRoot )} )
	} else {
		result = glob.sync( pattern, config )
	}

	return result
}

